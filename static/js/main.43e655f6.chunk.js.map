{"version":3,"sources":["timestamp.tsx","util.ts","NoteLine.ts","DriveSyncHandler.ts","Note.ts","LocalStore.ts","NoteContentHandler.ts","noterow.tsx","notetitle.tsx","menu.tsx","statusarea.tsx","App.tsx","serviceWorker.js","index.js"],"names":["Timestamp","props","interval","state","timestamp","initialTimestamp","className","this","toLocaleString","hour","minute","second","hour12","setState","Date","shouldTick","setupTimer","prevProps","prevState","window","clearInterval","setInterval","tick","React","Component","computeIndentString","units","Array","INDENT_LENGTH","fill","join","DriveSignInState","DriveSyncStatus","NoteLine","editTimestamp","note","indentedUnits","content","creationTimestamp","updateLastEditTime","setEditTimestamp","i","trim","length","id","getTime","rawNoteLine","noteLine","setContent","setCreationTimestamp","Note","noteLines","Map","noteLineIdsOrdered","title","creationTime","timestampsLocked","driveId","makeDefaultTitle","toLocaleDateString","makeNewLine","set","push","lineId","lineIndex","indexOf","console","error","splice","from","flatMap","get","Math","min","keys","locked","values","isEmpty","output","forEach","line","convertToText","max","delete","idIndex","orderedNoteLineIds","map","noteLineId","undefined","Error","serialize","rawNote","setTitle","setTimestampsLocked","setDriveId","parsedNoteLines","deserialize","noteLineMap","setNoteLines","getNoteStorageId","localStorage","JSON","stringify","lastEditKey","parse","debug","LocalStore","saveNote","getLastEditedNote","NoteRow","timestampElement","createRef","entryboxElement","getLine","rowId","getIndentedUnits","entryboxContent","computeEntryboxContent","getContent","editedSinceLastFocus","focused","ref","getLastEditTimestamp","computeTimestampShouldTick","inputRef","onFocus","handleEntryboxFocus","bind","onKeyDown","handleKeyDown","onChange","handleChange","value","readOnly","getTimestampsLocked","rawContent","oldProps","oldState","setIndentedUnits","NoteContentHandler","updateNote","current","focus","e","target","keyDownHandler","key","preventDefault","shiftKey","focusHandler","currentRawLength","textLength","setSelectionRange","NoteTitle","editing","titleValue","type","onClick","handleClick","onBlur","handleBlur","titleChangeHandler","currentTarget","DISCOVERY_DOCS","DOC_MIME","signedInEventHandlers","syncStatusChangeHandlers","fireSyncStatusChange","LOADING","gapi","load","initClient","client","init","apiKey","clientId","discoveryDocs","scope","then","auth2","getAuthInstance","isSignedIn","listen","handleIsSignedInState","log","SIGNED_OUT","signInState","SIGNED_IN","handler","newStatus","isUserSignedIn","SYNCING","getDriveId","getParentFolderId","parentId","drive","files","create","name","getTitle","mimeType","parents","response","status","result","uploadContent","SYNCED","xhr","XMLHttpRequest","open","setRequestHeader","getToken","access_token","Promise","resolve","reject","onload","send","Menu","driveSignInState","DriveSyncHandler","addSignInStateHandler","toggleTimestampsString","driveMenuItems","Dropdown","Item","signOutHandler","signInHandler","DropdownButton","alignRight","newNoteHandler","timestampLockToggleHandler","Divider","SyncStatusArea","addSyncStatusChangeHandler","handleSyncStatusChange","syncStatus","text","showDocsLink","noteDriveId","href","rel","LockIcon","visibleText","noteLocked","StatusArea","App","wrapperElement","editedSinceLastDriveSync","syncTimer","firstNoteLineId","createNewNote","getFirstNoteLineId","focusedNoteRowId","addLine","updateWindowTitle","noteId","setTimeout","syncTimerHandler","clearTimeout","noteRows","getLines","noteRow","handleNoteRowKeyDown","noteRowFocusHandler","handleTitleChange","handleToggleTimestampsLocked","signIn","signOut","newTitle","document","newNote","ctrlKey","addLineAfter","focusedRow","nextFocusedRowId","getPreviousRowId","deleteRow","Boolean","location","hostname","match","ReactDOM","render","getElementById","navigator","serviceWorker","ready","registration","unregister"],"mappings":"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","file":"static/js/main.43e655f6.chunk.js","sourcesContent":["import React from \"react\";\n\ninterface TimestampState {\n    timestamp: Date;\n}\n\ninterface TimestampProps {\n    shouldTick: boolean;\n    initialTimestamp: Date;\n}\n\nexport class Timestamp extends React.Component<TimestampProps, TimestampState> {\n    interval: number;\n\n    constructor(props: TimestampProps) {\n        super(props);\n        this.state = { timestamp: this.props.initialTimestamp };\n        this.interval = -1;\n    }\n\n    render() {\n        return (\n            <span className=\"timestamp\">\n                {this.state.timestamp.toLocaleString(\"en-us\", {\n                    hour: \"2-digit\",\n                    minute: \"2-digit\",\n                    second: \"2-digit\",\n                    hour12: false\n                })}\n            </span>\n        );\n    }\n\n    tick() {\n        this.setState(state => ({ timestamp: new Date() }));\n    }\n\n    componentDidMount() {\n        if (this.props.shouldTick) {\n            this.setupTimer();\n        }\n    }\n\n    componentDidUpdate(prevProps: TimestampProps, prevState: TimestampState) {\n        if (prevProps.shouldTick !== this.props.shouldTick) {\n            if (this.props.shouldTick) {\n                this.setupTimer();\n            } else {\n                window.clearInterval(this.interval);\n            }\n        }\n    }\n\n    setupTimer() {\n        this.interval = window.setInterval(() => this.tick(), 500);\n    }\n\n    componentWillUnmount() {\n        window.clearInterval(this.interval);\n    }\n}\n","import { INDENT_LENGTH } from './NoteLine'\r\n\r\nexport function computeIndentString(units: number): string {\r\n    /*eslint no-array-constructor: \"error\"*/\r\n    return new Array(units * INDENT_LENGTH)\r\n        .fill(\" \")\r\n        .join(\"\");\r\n}\r\n\r\nexport function removeIndent(str: string): string {\r\n    if (str.slice(0, INDENT_LENGTH - 1).trim().length === 0) {\r\n        return str.slice(INDENT_LENGTH);\r\n    }\r\n    \r\n    return str;\r\n}","import { Note } from \"./Note\";\nimport { computeIndentString } from \"./util\";\n\nexport const INDENT_LENGTH = 4;\n\nexport interface RawNoteLine {\n  content: string,\n  indentedUnits: number,\n  id: number,\n  editTimestamp: number;\n}\n\nexport class NoteLine {\n  private content: string = \"\";\n  private indentedUnits: number = 0;\n  private creationTimestamp: Date;\n\n  constructor(private editTimestamp: Date, private note: Note, indentedUnits?: number) {\n    this.creationTimestamp = new Date();\n    this.indentedUnits = indentedUnits || 0;\n  }\n\n  private setCreationTimestamp(timestamp: Date) {\n    this.creationTimestamp = timestamp;\n  }\n\n  get id(): number {\n    return this.creationTimestamp.getTime();\n  }\n\n  getContent(): string {\n    return this.content;\n  }\n\n  setContent(content: string, updateLastEditTime?: boolean) {\n    this.content = content;\n\n    if (updateLastEditTime) {\n      this.setEditTimestamp(new Date());\n    }\n  }\n\n  getLastEditTimestamp(): Date {\n    return this.editTimestamp;\n  }\n\n  setEditTimestamp(timestamp: Date) {\n    this.editTimestamp = timestamp;\n  }\n\n  getIndentedUnits(): number {\n    return this.indentedUnits;\n  }\n\n  setIndentedUnits(i: number) {\n    this.indentedUnits = i;\n  }\n\n  isEmpty(): boolean {\n    return (this.content.trim().length === 0);\n  }\n\n  convertToText(): string {\n    return this.editTimestamp.toLocaleString(\"en-us\", {\n                    hour: \"2-digit\",\n                    minute: \"2-digit\",\n                    second: \"2-digit\",\n                    hour12: false\n                })\n                + \" - \"\n                + computeIndentString(this.indentedUnits)\n                + this.content;\n  }\n\n  serialize(): RawNoteLine {\n    return {\n      id: this.id,\n      content: this.content,\n      indentedUnits: this.indentedUnits,\n      editTimestamp: this.editTimestamp.getTime()\n    }\n  }\n\n  static deserialize(note: Note, rawNoteLine: RawNoteLine): NoteLine {\n    let noteLine = new NoteLine(new Date(rawNoteLine.editTimestamp), note, rawNoteLine.indentedUnits);\n\n    noteLine.setContent(rawNoteLine.content)\n    noteLine.setCreationTimestamp(new Date(rawNoteLine.id));\n    return noteLine;\n  }\n}\n","import { Note } from \"./Note\";\r\n\r\ndeclare var gapi: any;\r\n\r\nconst API_KEY = \"AIzaSyBEH9v-TByqUFESw8vjl2YEDgAKoWm7n_8\";\r\nconst CLIENT_ID = \"370774814885-7kseam56ntmpklgnr9p00f8gh968cmtb.apps.googleusercontent.com\";\r\n// Array of API discovery doc URLs for APIs used by the quickstart\r\nconst DISCOVERY_DOCS = [\"https://www.googleapis.com/discovery/v1/apis/drive/v3/rest\"];\r\n\r\n// Authorization scopes required by the API; multiple scopes can be\r\n// included, separated by spaces.\r\nconst SCOPES = 'https://www.googleapis.com/auth/drive.file';\r\n\r\nconst DIRECTORY_MIME = \"application/vnd.google-apps.folder\";\r\nconst DOC_MIME = \"application/vnd.google-apps.document\";\r\n\r\nconst PARENT_NAME = \"Synced Interview Notes\";\r\nconst PARENT_ID_STORAGE_KEY = \"parent-drive-id\";\r\n\r\nexport enum DriveSignInState {\r\n    LOADING,\r\n    SIGNED_OUT,\r\n    SIGNED_IN\r\n}\r\n\r\nexport enum DriveSyncStatus {\r\n    LOADING,\r\n    SIGNED_OUT,\r\n    SYNCING,\r\n    SYNCED\r\n}\r\n\r\ntype SignedInEventHandler = (isSignedIn: DriveSignInState) => void;\r\ntype SyncStatusChangeHandler = (isSignedIn: DriveSyncStatus) => void;\r\n\r\nclass DriveSyncHandler {\r\n    private signedInEventHandlers: Array<SignedInEventHandler> = [];\r\n    private syncStatusChangeHandlers: Array<SyncStatusChangeHandler> = [];\r\n\r\n    async init(): Promise<void> {\r\n        this.fireSyncStatusChange(DriveSyncStatus.LOADING);\r\n        return gapi.load('client:auth2', this.initClient.bind(this));\r\n    }\r\n\r\n    initClient() {\r\n        gapi.client.init({\r\n            apiKey: API_KEY,\r\n            clientId: CLIENT_ID,\r\n            discoveryDocs: DISCOVERY_DOCS,\r\n            scope: SCOPES\r\n        }).then(() => {\r\n            // Listen for sign-in state changes.\r\n            gapi.auth2.getAuthInstance().isSignedIn.listen(this.handleIsSignedInState.bind(this));\r\n\r\n            this.handleIsSignedInState(gapi.auth2.getAuthInstance().isSignedIn.get());\r\n        })\r\n    }\r\n\r\n    handleIsSignedInState(isSignedIn: boolean) {\r\n        console.log('user is now', isSignedIn);\r\n\r\n        if (!isSignedIn) {\r\n            this.fireSyncStatusChange(DriveSyncStatus.SIGNED_OUT);\r\n        }\r\n\r\n        let signInState = (isSignedIn) ? DriveSignInState.SIGNED_IN : DriveSignInState.SIGNED_OUT;\r\n        for (let handler of this.signedInEventHandlers) {\r\n            handler(signInState);\r\n        }\r\n    }\r\n\r\n    addSignInStateHandler(handler: SignedInEventHandler) {\r\n        this.signedInEventHandlers.push(handler);\r\n    }\r\n\r\n    addSyncStatusChangeHandler(handler: SyncStatusChangeHandler) {\r\n        this.syncStatusChangeHandlers.push(handler);\r\n    }\r\n    \r\n    fireSyncStatusChange(newStatus: DriveSyncStatus) {\r\n        for (let handler of this.syncStatusChangeHandlers) {\r\n            handler(newStatus);\r\n        }\r\n    }\r\n\r\n    isUserSignedIn(): boolean {\r\n        return gapi.auth2.getAuthInstance().isSignedIn.get()\r\n    }\r\n\r\n    async saveNote(note: Note): Promise<string> {\r\n        if (!this.isUserSignedIn()) {\r\n            return \"\";\r\n        }\r\n\r\n        this.fireSyncStatusChange(DriveSyncStatus.SYNCING);\r\n        let id = \"\";\r\n        if (note.getDriveId().length === 0 && !note.isEmpty()) {\r\n            console.log(\"Creating new note to drive: \", note);\r\n            let parentId = await this.getParentFolderId();\r\n\r\n            let response = await gapi.client.drive.files.create({\r\n                name: note.getTitle(),\r\n                mimeType: DOC_MIME,\r\n                parents: [parentId],\r\n            })\r\n\r\n            console.log(\"Got create response: \", response);\r\n\r\n            if (response.status !== 200) {\r\n                throw new Error(\"Got bad create response code\");\r\n            }\r\n            id = response.result.id;\r\n        } else if (note.getDriveId().length !== 0) {\r\n            console.log(\"Saving note to drive: \", note);\r\n            id = note.getDriveId();\r\n        }\r\n\r\n        if (id.length > 0) {\r\n            await this.uploadContent(id, note.convertToText());\r\n        }\r\n        this.fireSyncStatusChange(DriveSyncStatus.SYNCED);\r\n\r\n        return id;\r\n    }\r\n\r\n    async getParentFolderId(): Promise<string> {\r\n        let id = window.localStorage[PARENT_ID_STORAGE_KEY];\r\n        if (id === undefined) {\r\n            console.log(\"Creating new parent folder...\");\r\n            let response = await gapi.client.drive.files.create({\r\n                mimeType: DIRECTORY_MIME,\r\n                name: PARENT_NAME\r\n            })\r\n\r\n            console.log(\"got create response: \", response);\r\n            if (response.status !== 200) {\r\n                throw new Error(\"Got bad create response code\");\r\n            }\r\n\r\n            id = response.result.id;\r\n            window.localStorage[PARENT_ID_STORAGE_KEY] = id;\r\n        } else {\r\n            console.log(\"Reusing drive id: \", id);\r\n        }\r\n        return id;\r\n    }\r\n\r\n    async uploadContent(driveId: string, content: string): Promise<string> {\r\n        console.log(\"About to upload content for\", driveId);\r\n        let xhr = new XMLHttpRequest();\r\n        xhr.open(\"PATCH\", \"https://www.googleapis.com/upload/drive/v3/files/\" + driveId + \"?uploadType=media\");\r\n        xhr.setRequestHeader(\"Authorization\", \"Bearer \" + gapi.client.getToken().access_token);\r\n        xhr.setRequestHeader(\"Content-Type\", DOC_MIME);\r\n\r\n        return new Promise<string>((resolve, reject) => {\r\n            xhr.onload = () => resolve();\r\n            xhr.send(content);\r\n        });\r\n    }\r\n}\r\n\r\n\r\nexport default new DriveSyncHandler();","import { RawNoteLine, NoteLine } from \"./NoteLine\";\n\nexport interface RawNote {\n  id: number,\n  title: string,\n  noteLines: Array<RawNoteLine>\n  timestampsLocked: boolean;\n  driveId: string;\n}\n\nexport class Note {\n  noteLines: Map<number, NoteLine> = new Map<number, NoteLine>();\n  // Since new lines can be inserted anywhere in the note, we need\n  // a separate array keeping track of the visual ordering of the rows\n  // in the note relative to each other.\n  noteLineIdsOrdered: Array<number> = [];\n  private title: string;\n  private creationTime: Date;\n  private timestampsLocked: boolean = false;\n  private driveId: string = \"\";\n\n  constructor() {\n    this.creationTime = new Date();\n\n    this.title = this.makeDefaultTitle();\n  }\n\n  makeDefaultTitle(): string {\n    return \"Interview on \"+ this.creationTime.toLocaleDateString();\n  }\n\n  get id(): number {\n    return this.creationTime.getTime();\n  }\n\n  private makeNewLine(indentedUnits?: number): NoteLine {\n    return new NoteLine(new Date(), this, indentedUnits);\n  }\n\n  addLine(indentedUnits?: number): NoteLine {\n    let noteLine = this.makeNewLine(indentedUnits);\n    this.noteLines.set(noteLine.id, noteLine);\n    this.noteLineIdsOrdered.push(noteLine.id);\n\n    return noteLine;\n  }\n\n  addLineAfter(lineId: number, indentedUnits?: number): (NoteLine | null) {\n    let lineIndex = this.noteLineIdsOrdered.indexOf(lineId);\n\n    if (lineIndex === -1) {\n      console.error(\"Got bad line id in addLineAfter:\", lineId, \"; current note:\", this);\n      return null;\n    }\n\n    let noteLine = this.makeNewLine(indentedUnits);\n\n    this.noteLines.set(noteLine.id, noteLine);\n    this.noteLineIdsOrdered.splice(lineIndex + 1, 0, noteLine.id);\n    return noteLine;\n  }\n\n  getLines(): Array<NoteLine> {\n    return Array.from(this.noteLineIdsOrdered.flatMap(id => {\n      let noteLine = this.noteLines.get(id);\n      if (noteLine) {\n        return [noteLine];\n      }\n      return [];\n    }));\n  }\n\n  getLine(id: number): NoteLine | undefined {\n    return this.noteLines.get(id);\n  }\n\n  getFirstNoteLineId(): number {\n    return Math.min(...Array.from(this.noteLines.keys()));\n  }\n\n  getTitle(): string {\n      return this.title;\n  }\n\n  setTitle(title: string) {\n    this.title = title;\n  }\n\n  getTimestampsLocked(): boolean {\n    return this.timestampsLocked;\n  }\n\n  setTimestampsLocked(locked: boolean) {\n    this.timestampsLocked = locked;\n  }\n\n  getDriveId(): string {\n    return this.driveId || \"\";\n  }\n\n  setDriveId(driveId: string) {\n    this.driveId = driveId;\n  }\n\n  isEmpty(): boolean {\n    for (let line of this.noteLines.values()) {\n      if (!line.isEmpty()) {\n        return false;\n      }\n    }\n\n    return true;\n  }\n\n  convertToText(): string {\n\n    let output = \"\";\n    this.noteLines.forEach(line => {\n      output += line.convertToText() + \"\\n\";\n    });\n\n    return output;\n  }\n\n  getPreviousRowId(id: number): number | null {\n    let lineIndex = this.noteLineIdsOrdered.indexOf(id);\n\n    if (lineIndex === -1) {\n      return null;\n    }\n\n    return this.noteLineIdsOrdered[Math.max(0, lineIndex - 1)];\n  }\n\n  deleteRow(id: number) {\n    this.noteLines.delete(id);\n    let idIndex = this.noteLineIdsOrdered.indexOf(id);\n\n    if (idIndex !== -1) {\n      this.noteLineIdsOrdered.splice(idIndex, 1);\n    } else {\n      console.error(\"Tried to delete non-existent row with ID: \", id, this);\n    }\n  }\n\n  private setNoteLines(orderedNoteLineIds: Array<number>, noteLines: Map<number, NoteLine>) {\n    this.noteLineIdsOrdered = orderedNoteLineIds;\n    this.noteLines = noteLines;\n  }\n\n  serialize(): RawNote {\n    return {\n      title: this.title,\n      id: this.id,\n      timestampsLocked: this.timestampsLocked,\n      driveId: this.driveId,\n      noteLines: this.noteLineIdsOrdered.map(noteLineId => {\n        let noteLine = this.noteLines.get(noteLineId);\n        \n        if (noteLine === undefined) {\n          console.error(\"Note: \", this);\n          throw new Error(\"Got undefined note line during serialization.\");\n        }\n\n        return noteLine.serialize();\n      })\n    }\n  }\n\n  static deserialize(rawNote: RawNote): Note {\n    let note = new Note();\n    note.setTitle(rawNote.title);\n    note.setTimestampsLocked(rawNote.timestampsLocked);\n    note.setDriveId(rawNote.driveId);\n\n    let parsedNoteLines = rawNote.noteLines.map(rawNoteLine => NoteLine.deserialize(note, rawNoteLine));\n    let noteLineMap = new Map<number, NoteLine>();\n    parsedNoteLines.forEach(noteLine => noteLineMap.set(noteLine.id, noteLine));\n    note.setNoteLines(rawNote.noteLines.map(rawNoteLine => rawNoteLine.id), noteLineMap);\n    return note;\n  }\n}\n","import { Note } from \"./Note\";\r\n\r\nconst LAST_EDIT_KEY = 'lastEditedNote';\r\nclass LocalStore {\r\n\r\n    saveNote(note: Note) {\r\n        let id = this.getNoteStorageId(note);\r\n        window.localStorage[id] = JSON.stringify(note.serialize());\r\n        window.localStorage[LAST_EDIT_KEY] = id;\r\n    }\r\n\r\n    getLastEditedNote(): Note | null {\r\n        let lastEditKey = window.localStorage[LAST_EDIT_KEY];\r\n        if (lastEditKey === undefined) {\r\n            return null;\r\n        }\r\n\r\n        let rawNote = window.localStorage[lastEditKey];\r\n\r\n        if (rawNote === undefined) {\r\n            console.error(\"Tried to fetch non-existent note: \", lastEditKey);\r\n            return null;\r\n        }\r\n\r\n        return Note.deserialize(JSON.parse(rawNote));\r\n    }\r\n\r\n    getNoteStorageId(note: Note): string {\r\n        return 'note-' + note.id;\r\n    }\r\n}\r\n\r\nexport default new LocalStore();","import { Note } from './Note';\r\nimport LocalStore from \"./LocalStore\";\r\n\r\nclass NoteContentHandler {\r\n    updateNote(note: Note) {\r\n        console.debug(\"Updating note: \", note);\r\n        LocalStore.saveNote(note);\r\n    }\r\n\r\n    getLastEditedNote(): Note | null {\r\n        return LocalStore.getLastEditedNote();\r\n    }\r\n}\r\n\r\nexport default new NoteContentHandler();","import React from \"react\";\nimport { Timestamp } from \"./timestamp\";\nimport { NoteLine } from \"./NoteLine\";\nimport { Note } from \"./Note\";\nimport NoteContentHandler from \"./NoteContentHandler\";\nimport { computeIndentString } from \"./util\";\nimport TextareaAutosize from 'react-textarea-autosize';\n\n\ninterface NoteRowProps {\n    focusHandler: Function;\n    keyDownHandler: Function;\n    note: Note;\n    rowId: number;\n    focused: boolean;\n}\n\ninterface NoteRowState {\n    indentedUnits: number;\n    entryboxContent: string;\n    editedSinceLastFocus: boolean;\n}\n\nexport class NoteRow extends React.Component<NoteRowProps, NoteRowState> {\n    timestampElement = React.createRef<Timestamp>();\n    entryboxElement = React.createRef<HTMLTextAreaElement>();\n    noteLine: NoteLine;\n\n    constructor(props: NoteRowProps) {\n        super(props);\n\n        let noteLine = props.note.getLine(props.rowId);\n        if (noteLine === undefined) {\n            console.error(\"Note: \", props.note);\n            throw new Error(\"Got bad row id. Provided row id: \" + props.rowId);\n        }\n\n        this.noteLine = noteLine;\n\n        this.state = {\n            indentedUnits: this.noteLine.getIndentedUnits(),\n            entryboxContent: this.computeEntryboxContent(this.noteLine.getIndentedUnits(), this.noteLine.getContent()),\n            editedSinceLastFocus: false\n        };\n    }\n\n    render() {\n        return (\n            <div className={`noterow ${this.props.focused ? 'noterow-focused' : 'noterow-unfocused'}`}>\n                <Timestamp ref={this.timestampElement}\n                    initialTimestamp={this.noteLine.getLastEditTimestamp()}\n                    shouldTick={this.computeTimestampShouldTick()} />\n                <TextareaAutosize inputRef={this.entryboxElement}\n                    onFocus={this.handleEntryboxFocus.bind(this)}\n                    onKeyDown={this.handleKeyDown.bind(this)}\n                    onChange={this.handleChange.bind(this)}\n                    value={this.state.entryboxContent}\n                    readOnly={!this.props.focused}\n                    className=\"entrybox\" />\n            </div>\n        )\n    }\n\n    computeTimestampShouldTick() {\n        if (this.props.note.getTimestampsLocked()) {\n            return false;\n        }\n\n        let isEmpty = (this.state.entryboxContent.trim().length === 0);\n        if (isEmpty && this.props.focused) {\n            return true;\n        }\n        \n        if (!isEmpty && this.state.editedSinceLastFocus) {\n            return true;\n        }\n\n        return false;\n    }\n\n    computeEntryboxContent(indentedUnits: number, rawContent: string) {\n        return computeIndentString(indentedUnits) + rawContent.trim();\n    }\n\n\n    componentDidUpdate(oldProps: NoteRowProps, oldState: NoteRowState) {\n        if (oldState.indentedUnits !== this.state.indentedUnits) {\n            this.setState(state => ({\n                entryboxContent: this.computeEntryboxContent(this.state.indentedUnits, this.state.entryboxContent)\n            }));\n            this.noteLine.setIndentedUnits(this.state.indentedUnits);\n        }\n\n        if (oldState.entryboxContent !== this.state.entryboxContent) {\n            this.noteLine.setContent(this.state.entryboxContent, true);\n            NoteContentHandler.updateNote(this.props.note);\n        }\n\n        if (oldProps.focused !== this.props.focused && !this.props.focused) {\n            this.setState({ editedSinceLastFocus: false })\n        }\n        if (this.entryboxElement.current !== null) {\n            if (this.props.focused) {\n                this.entryboxElement.current.focus();\n            }\n        }\n    }\n\n    componentDidMount() {\n        if (this.entryboxElement.current !== null) {\n            if (this.props.focused) {\n                this.entryboxElement.current.focus();\n            }\n        }\n    }\n\n    handleChange(e: React.ChangeEvent) {\n        this.setState({ entryboxContent: (e.target as HTMLTextAreaElement).value, editedSinceLastFocus: true });\n        NoteContentHandler.updateNote(this.props.note);\n    }\n\n    handleKeyDown(e: React.KeyboardEvent) {\n        if (!this.props.keyDownHandler(this.noteLine, e)) {\n            return;\n        }\n\n        if (e.key === \"Tab\") {\n            e.preventDefault();\n            if (e.shiftKey) {\n                this.setState(state => ({ indentedUnits: Math.max(state.indentedUnits - 1, 0) }));\n            } else {\n                this.setState(state => ({ indentedUnits: state.indentedUnits + 1 }));\n            }\n        }\n    }\n\n    handleEntryboxFocus(e: React.FocusEvent) {\n        this.props.focusHandler(this.noteLine);\n\n        if (this.state.entryboxContent.trim().length === 0 && this.entryboxElement.current != null) {\n            let currentRawLength = this.entryboxElement.current.textLength;\n            this.entryboxElement.current.setSelectionRange(currentRawLength, currentRawLength);\n        }\n    }\n}","import React from 'react';\n\ninterface NoteTitleProps {\n    title: string;\n    titleChangeHandler: (newTitle: string) => any;\n}\n\ninterface NoteTitleState {\n    editing: boolean;\n    titleValue: string;\n}\n\nexport class NoteTitle extends React.Component<NoteTitleProps, NoteTitleState> {\n    inputRef = React.createRef<HTMLInputElement>();\n\n    constructor(props: NoteTitleProps) {\n        super(props);\n\n        this.state = { editing: false, titleValue: props.title};\n    }\n\n    render() {\n        return (\n            <div className=\"note-title\">\n                <input type=\"text\"\n                    ref={this.inputRef}\n                    onClick={this.handleClick.bind(this)}\n                    onKeyDown={this.handleKeyDown.bind(this)}\n                    onChange={this.handleChange.bind(this)}\n                    onBlur={this.handleBlur.bind(this)}\n                    value={this.state.titleValue} />\n            </div>\n        )\n    }\n\n    handleClick(e: React.MouseEvent) {\n        this.setState({ editing: true });\n    }\n\n    handleKeyDown(e: React.KeyboardEvent) {\n        if (e.key === 'Enter') {\n            e.preventDefault();\n\n            this.props.titleChangeHandler(this.state.titleValue)\n            this.setState({ editing: false});\n        }\n    }\n\n    handleChange(e: React.FormEvent<HTMLInputElement>) {\n        e.preventDefault();\n        this.setState({ titleValue: e.currentTarget.value});\n    }\n\n    handleBlur(e: React.FocusEvent) {\n        this.setState({titleValue: this.props.title});\n    }\n}","import React from 'react';\r\nimport Dropdown from 'react-bootstrap/Dropdown';\r\nimport DropdownButton from 'react-bootstrap/DropdownButton';\r\nimport {DriveSignInState} from './DriveSyncHandler';\r\nimport DriveSyncHandler from './DriveSyncHandler';\r\n\r\ninterface MenuProps {\r\n    newNoteHandler: () => void;\r\n    timestampLockToggleHandler: () => void;\r\n    signInHandler: () => void;\r\n    signOutHandler: () => void;\r\n    timestampsLocked: boolean;\r\n}\r\n\r\ninterface MenuState {\r\n  open: boolean;\r\n  driveSignInState: DriveSignInState;\r\n}\r\n\r\nexport class Menu extends React.Component<MenuProps, MenuState> {\r\n    constructor(props: MenuProps) {\r\n        super(props);\r\n\r\n        this.state = { open: false, driveSignInState: DriveSignInState.LOADING}\r\n        DriveSyncHandler.addSignInStateHandler((isSignedIn: DriveSignInState) =>{\r\n            this.setState({ driveSignInState: isSignedIn})\r\n        })\r\n    }\r\n\r\n    render() {\r\n        let toggleTimestampsString = (this.props.timestampsLocked)\r\n                        ? \"Unlock Timestamps\"\r\n                        : \"Lock Timestamps\";\r\n        \r\n        let driveMenuItems: Array<any> = [];\r\n\r\n        if (this.state.driveSignInState === DriveSignInState.SIGNED_IN) {\r\n            driveMenuItems = [\r\n                <Dropdown.Item key=\"signout\" onClick={(e: React.MouseEvent<any>) => this.props.signOutHandler()}>\r\n                    Sign out of Google Drive\r\n                </Dropdown.Item>\r\n            ]\r\n        } else if (this.state.driveSignInState === DriveSignInState.SIGNED_OUT) {\r\n            driveMenuItems = [\r\n                <Dropdown.Item key=\"signin\" onClick={(e: React.MouseEvent<any>) => this.props.signInHandler()}>\r\n                    Sign into Google Drive\r\n                </Dropdown.Item>\r\n            ];\r\n        } else {\r\n            driveMenuItems = [\r\n                <Dropdown.Item key=\"loading\" onClick={(e: React.MouseEvent<any>) => this.props.signInHandler()}>\r\n                    Drive Login Loading...\r\n                </Dropdown.Item>\r\n            ];\r\n        }\r\n\r\n        \r\n        return (\r\n            <DropdownButton alignRight id=\"menu\" title=\"Menu\">\r\n                <Dropdown.Item onClick={(e: React.MouseEvent<any>) => this.props.newNoteHandler()}>New Note</Dropdown.Item>\r\n                <Dropdown.Item onClick={(e: React.MouseEvent<any>) => this.props.timestampLockToggleHandler()}>\r\n                    {toggleTimestampsString}\r\n                </Dropdown.Item>\r\n                <Dropdown.Divider />\r\n                {driveMenuItems}\r\n            </DropdownButton>\r\n        )\r\n    }\r\n\r\n    handleMenuIconClick(e: React.MouseEvent) {\r\n    }\r\n\r\n    resetHandler(e: React.MouseEvent) {\r\n    }\r\n}","import React from \"react\";\r\nimport DriveSyncHandler, { DriveSyncStatus } from \"./DriveSyncHandler\";\r\n\r\ninterface SyncStatusAreaProps {\r\n  noteDriveId: string;\r\n}\r\n\r\ninterface SyncStatusAreaState {\r\n    syncStatus: DriveSyncStatus;\r\n}\r\n\r\nclass SyncStatusArea extends React.Component<SyncStatusAreaProps, SyncStatusAreaState> {\r\n    constructor(props: SyncStatusAreaProps) {\r\n        super(props);\r\n\r\n        DriveSyncHandler.addSyncStatusChangeHandler(this.handleSyncStatusChange.bind(this));\r\n        this.state = {syncStatus: DriveSyncStatus.LOADING };\r\n    }\r\n\r\n    handleSyncStatusChange(newStatus: DriveSyncStatus) {\r\n        this.setState({ syncStatus: newStatus });\r\n    }\r\n\r\n  render() {\r\n      let className = \"\";\r\n      let text = \"\";\r\n\r\n      switch (this.state.syncStatus) {\r\n          case DriveSyncStatus.SYNCING:\r\n              className = \"syncing\";\r\n              text = \"Syncing note to Drive...\";\r\n              break;\r\n          case DriveSyncStatus.SYNCED:\r\n              className = \"synced\";\r\n              text = \"Add content to sync note...\";\r\n              break;\r\n          case DriveSyncStatus.LOADING:\r\n              className = \"loading\";\r\n              text = \"Loading Drive state...\";\r\n              break;\r\n          case DriveSyncStatus.SIGNED_OUT:\r\n              className = \"signed-out\";\r\n              text = \"Not signed into Drive\";\r\n              break;\r\n      }\r\n\r\n      let showDocsLink = (this.props.noteDriveId.length > 0 && \r\n                            (this.state.syncStatus === DriveSyncStatus.SYNCED ||\r\n                             this.state.syncStatus === DriveSyncStatus.SYNCING));\r\n    return (\r\n      <div className={\"view-in-docs-link \" + className}>\r\n        {showDocsLink && \r\n                <a href={\"https://docs.google.com/document/d/\" + this.props.noteDriveId + \"/edit\"}\r\n                    rel=\"noopener noreferrer\"\r\n                    target=\"_blank\">\r\n            View Note in Drive\r\n          </a>}\r\n          {!showDocsLink && text}\r\n      </div>\r\n    )\r\n  }\r\n}\r\n\r\ninterface LockIconProps {\r\n  noteLocked: boolean\r\n}\r\n\r\ninterface LockIconState {\r\n}\r\n\r\nclass LockIcon extends React.Component<LockIconProps, LockIconState> {\r\n  render() {\r\n      let visibleText = this.props.noteLocked ? \"visible\" : \"invisible\";\r\n\r\n      return (\r\n          <span className={\"note-locked-icon \" + visibleText}\r\n                title=\"Timestamps are locked. Unlock via the menu.\"></span>\r\n      )\r\n  }\r\n}\r\n\r\ninterface StatusAreaProps {\r\n    noteDriveId: string;\r\n    timestampsLocked: boolean;\r\n}\r\n\r\ninterface StatusAreaState {}\r\n\r\nexport default class StatusArea extends React.Component<StatusAreaProps, StatusAreaState> {\r\n    render() {\r\n        return <div className=\"status-area\">\r\n            <SyncStatusArea noteDriveId={this.props.noteDriveId} />\r\n            <LockIcon noteLocked={this.props.timestampsLocked} />\r\n        </div>\r\n\r\n    }\r\n}","import React from 'react';\nimport './App.css';\nimport 'bootstrap/dist/css/bootstrap.min.css';\nimport { NoteRow } from './noterow';\nimport { NoteLine } from './NoteLine';\nimport { NoteTitle } from './notetitle';\nimport { Note } from './Note';\nimport { Menu } from './menu';\nimport NoteContentHandler from './NoteContentHandler';\nimport DriveSyncHandler, { DriveSignInState } from './DriveSyncHandler';\nimport StatusArea from './statusarea';\n\n\ndeclare var gapi: any\n\nconst SYNC_TIMEOUT = 2000;\n\ninterface AppProps {\n}\n\ninterface AppState {\n  focusedNoteRowId: number\n  note: Note\n}\n\nclass App extends React.Component<AppProps, AppState> {\n  wrapperElement = React.createRef<HTMLDivElement>();\n\n  private editedSinceLastDriveSync = false;\n  private syncTimer: NodeJS.Timeout | null = null;\n\n  constructor(props: AppProps) {\n    super(props);\n    DriveSyncHandler.init();\n\n    let note = NoteContentHandler.getLastEditedNote();\n    let firstNoteLineId: number;\n\n    if (note === null) {\n      note = this.createNewNote();\n      firstNoteLineId = note.getFirstNoteLineId();\n    } else {\n      firstNoteLineId = note.getFirstNoteLineId();\n    }\n    this.state = { note: note, focusedNoteRowId: firstNoteLineId };\n  }\n\n  createNewNote(): Note {\n      let note = new Note();\n      note.addLine();\n\n      return note;\n  }\n\n  componentDidMount() {\n    this.updateWindowTitle();\n    DriveSyncHandler.addSignInStateHandler((state: DriveSignInState) => {\n      if (state !== DriveSignInState.SIGNED_IN) {\n        if (this.syncTimer !== null) {\n          clearTimeout(this.syncTimer);\n          this.syncTimer = null;\n        }\n        return;\n      }\n\n      DriveSyncHandler.saveNote(this.state.note).then(noteId => {\n        let note = this.state.note;\n        if (noteId.length > 0) {\n          note.setDriveId(noteId);\n          this.setState({ note: note });\n        }\n\n        setTimeout(this.syncTimerHandler.bind(this), SYNC_TIMEOUT);\n      });\n    });\n  }\n\n  componentDidUpdate(oldProps: AppProps, oldState: AppState) {\n    if (oldState.note.getTitle() !== this.state.note.getTitle()) {\n      this.updateWindowTitle();      \n    }\n\n  }\n\n  async syncTimerHandler() {\n    if (this.editedSinceLastDriveSync) {\n      let id = await DriveSyncHandler.saveNote(this.state.note);\n      if (id.length > 0) {\n        let note = this.state.note;\n        note.setDriveId(id);\n        this.setState({ note: note })\n      }\n      this.editedSinceLastDriveSync = false;\n    }\n\n    this.syncTimer = setTimeout(this.syncTimerHandler.bind(this), SYNC_TIMEOUT);\n  }\n\n  render() {\n    let noteRows = this.state.note.getLines().map(noteRow => {\n      return (<NoteRow keyDownHandler={this.handleNoteRowKeyDown.bind(this)}\n        focusHandler={this.noteRowFocusHandler.bind(this)}\n        note={this.state.note}\n        rowId={noteRow.id}\n        key={noteRow.id}\n        focused={noteRow.id === this.state.focusedNoteRowId} />);\n    });\n\n    return (\n      <div className=\"App\" ref={this.wrapperElement}>\n        <div className=\"header\">\n          <NoteTitle title={this.state.note.getTitle()} titleChangeHandler={this.handleTitleChange.bind(this)} />\n          <StatusArea noteDriveId={this.state.note.getDriveId()}\n                      timestampsLocked={this.state.note.getTimestampsLocked()} />\n          <Menu timestampsLocked={this.state.note.getTimestampsLocked()} \n            newNoteHandler={this.newNoteHandler.bind(this)}\n            timestampLockToggleHandler={this.handleToggleTimestampsLocked.bind(this)}\n            signOutHandler={this.signOutHandler.bind(this)}\n            signInHandler={this.signInHandler.bind(this)} />\n        </div>\n        {noteRows}\n      </div>\n    );\n  }\n\n  signInHandler() {\n    gapi.auth2.getAuthInstance().signIn();\n  }\n\n  signOutHandler() {\n    gapi.auth2.getAuthInstance().signOut();\n  }\n\n  handleTitleChange(newTitle: string) {\n    this.state.note.setTitle(newTitle);\n    this.setState({ note: this.state.note });\n    NoteContentHandler.updateNote(this.state.note);\n  }\n\n  updateWindowTitle() {\n    document.title = this.state.note.getTitle() + \" - Interview Notes\";\n  }\n\n  handleToggleTimestampsLocked() {\n    let note = this.state.note;\n\n    note.setTimestampsLocked(!note.getTimestampsLocked());\n    this.setState({ note: note });\n  }\n\n  newNoteHandler() {\n    let note = this.createNewNote();\n    // Set this to true so that a sync happens immediately.\n    this.editedSinceLastDriveSync = true;\n    this.setState({ note: note, focusedNoteRowId: note.getFirstNoteLineId() });\n  }\n\n  handleNoteRowKeyDown(noteRow: NoteLine, e: React.KeyboardEvent) {\n    this.editedSinceLastDriveSync = true;\n\n    if (e.key === \"Enter\" && !e.shiftKey) {\n      e.preventDefault();\n      let note = this.state.note;\n      let newNote: NoteLine | null;\n\n      if (e.ctrlKey) {\n        newNote = note.addLine(noteRow.getIndentedUnits());\n      } else {\n        newNote = note.addLineAfter(this.state.focusedNoteRowId, noteRow.getIndentedUnits());\n      }\n\n      if (newNote === null) {\n        return false;\n      }\n\n      this.setState({ note: note, focusedNoteRowId: newNote.id });\n      return false;\n    } else if (e.key === \"Backspace\") {\n      let focusedRow = this.state.note.getLine(this.state.focusedNoteRowId);\n      if (focusedRow !== undefined && focusedRow.isEmpty() && this.state.note.getLines().length > 1) {\n        let nextFocusedRowId = this.state.note.getPreviousRowId(this.state.focusedNoteRowId);\n        this.state.note.deleteRow(this.state.focusedNoteRowId);\n\n        if (nextFocusedRowId !== null) {\n          if (nextFocusedRowId === this.state.focusedNoteRowId) {\n            // This means the first line had focus, so the new first line\n            // should now have focus.\n            nextFocusedRowId = this.state.note.getFirstNoteLineId();\n          }\n\n          this.setState({ focusedNoteRowId: nextFocusedRowId });\n        } else {\n          console.error(\"Got a null previous row id relative to: \", this.state.focusedNoteRowId);\n          this.setState({ focusedNoteRowId: this.state.note.getFirstNoteLineId() });\n        }\n\n        NoteContentHandler.updateNote(this.state.note);\n\n        // Since we're catching the keydown event, if we don't call preventDefault,\n        // a character will get deleted on the line that gets focus.\n        e.preventDefault();\n\n      }\n    } else if (e.key === \"s\" && e.ctrlKey) {\n      // Override Ctrl+S to force a save. This really shouldn't do anything in practice,\n      // since the timer should be running, but it makes it safe for users who have\n      // Ctrl+S muscle memory to use it.\n      DriveSyncHandler.saveNote(this.state.note);\n      e.preventDefault();\n    } else {\n      return true;\n    }\n\n  }\n\n  noteRowFocusHandler(note: NoteLine) {\n    this.setState({ focusedNoteRowId: note.id });\n  }\n}\n\nexport default App;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\n\nReactDOM.render(<App />, document.getElementById('root'));\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}